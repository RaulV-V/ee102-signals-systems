\makeatletter
\def\input@path{{../styles/}{../../styles/}{../../../styles/}{../}{../../}{../../../}}
\makeatother


\documentclass{ee102_pset}
\input{macros.tex}
\input{preamble.tex}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{listings}
\usepackage[american]{circuitikz}

% Assignment info
\author{\rule{3cm}{0.4pt}} % Name placeholder
\submitdate{\rule{3cm}{0.4pt}} % Submission date placeholder
\problemset{Homework \#3: LTI Systems}
\renewcommand{\duedate}{September 22, 2025}
\shorttitle{Homework \#3}

\begin{document}

% Problem 1
\problem{1} [Adapted from Vierinen 7.1-1]

You often hear that ``noise cancelling'' works by playing a signal that is completely out of phase with the noise, thus cancelling its perception to the listener. In this problem, you will be asked to mathematically analyze (and prove) this concept. Consider a noise signal given by
\[
x_{\text{noise}}(t)=\cos(\omega t+\phi).
\]
A cancellation signal of the \emph{same frequency} is
\[
x_{\text{cancel}}(t)=\cos(\omega t+\phi_c).
\]

\problempart{\textbf{[10 points]}}
Find a value of $\phi_c$ such that $x_{\text{noise}}(t)+x_{\text{cancel}}(t)\equiv 0$. Assume equal amplitudes. Hint: use the cosine addition formula and trignometric identities.

\medskip

\problempart{\textbf{[15 points]}} Now suppose
\[
x_{\text{noise}}(t)=A\cos(\omega t+\phi),\qquad
x_{\text{cancel}}(t)=B\cos(\omega t+\phi_c),
\]
with $A,B>0$ not \emph{a priori} equal. Using \textbf{complex exponentials}, determine conditions on $B$ and $\phi_c$ for \emph{perfect} cancellation for all $t$. If $B\neq A$ is fixed, is perfect cancellation possible? Discuss the differences in the two methods.



\problempart{\textbf{[5 points]}}
Propose a simple LTI system that, when driven by $x_{\text{noise}}(t)=\cos(\omega_0 t+\phi)$, produces an output $y(t)$ that cancels the noise when added to $x_{\text{noise}}(t)$. Draw a block diagram of your system.

\problempart
Verify your results with Python.
\begin{enumerate}
    \item \textbf{[5 points]} Generate a signal $x(t)$, generate the cancelling signal, and plot $x$, $y$, and $x+y$ on the same axes.
    \item Explore two mismatch cases: (i) \textbf{[5 points]} phase error $\Delta\phi=5^\circ$ with $B=A$, and (ii) \textbf{[5 points]} amplitude error $B=(1+\epsilon)A$ with $\epsilon=0.05$ and perfect phase.
    \item \textbf{[5 points]} Compute the RMS (root mean squared) of the residual signal $r(t)=x(t)+y(t)$ in each case. The RMS is defined as
    \[
\text{RMS} = \sqrt{\frac{1}{N}\sum_{n=1}^{N} r(t_n)^2}
\]
where $t_n$ are the sample times and $N$ is the number of samples.
\end{enumerate}

Hint: You may use the following starter code (adapted from Vierinen 7.1-1).

\begin{lstlisting}[style=py,caption={Starter code for Part (d)},label=lst:noise-cancel]
import numpy as np
import matplotlib.pyplot as plt

N = 1000                 # samples
om = 2.6                 # angular frequency
phi = 3.1                # phase of the noise
A = 1.0                  # noise amplitude
m = 0                    # integer
t = np.linspace(0, 4*np.pi, N)

# Perfect cancellation parameters
phi_cancel = np.pi - phi + 2*np.pi*m
B = A

x = A*np.cos(om*t + phi)                 # noise
y = B*np.cos(om*t + phi_cancel)          # canceller
r = x + y                                # residual

plt.plot(t, x, label='noise x')
plt.plot(t, y, label='cancel y')
plt.plot(t, r, label='residual x+y')
plt.legend(); plt.xlabel('t'); plt.grid(True)
plt.show()
\end{lstlisting}


\vspace*{\fill}
\begin{center}
[use more pages if needed]
\end{center}
\problem{2} [Adapted from Lathi P1.7-4] Consider the following system that models an operational amplifier with guard rails $\pm V_{\text{ref}}$ and a propagation delay $t_p>0$:
\[
y(t+t_p)=
\begin{cases}
-\,V_{\text{ref}}, & x(t)> V_{\text{ref}},\\[2pt]
\phantom{-}V_{\text{ref}}, & x(t)<-V_{\text{ref}},\\[2pt]
-\,x(t), & \text{otherwise}.
\end{cases}
\]
Equivalently, letting $\operatorname{clip}(v)=\max(-V_{\text{ref}},\min(v,V_{\text{ref}}))$,
\[
y(t+t_p) \;=\; -\,\operatorname{clip}\big(x(t)\big).
\]

Prove/disprove the following:

\problempart{\textbf{[5 points]}} Sketch the static input-output curve and mark the slopes.
\problempart{\textbf{[5 points]}} Is the system causal?
\problempart{\textbf{[5 points]}} Is it invertible? If not, characterize the largest input set on which it \emph{is} invertible.
\problempart{\textbf{[5 points]}} Is it linear? 
\problempart{\textbf{[5 points]}} Is it time-invariant? Prove or give a counterexample.
\problempart{\textbf{[5 points]}} Compute and sketch $y(t)$ for $x(t)=A\cos(\omega t)$ with $A>V_{\text{ref}}$ (i.e., a clipped sinusoid), and indicate the time fraction spent at each rail.


\vspace*{\fill}
\begin{center}
[use more pages if needed]
\end{center}
% =========================================================
% Problem 3
% =========================================================
\problem{3}
% \; LTI with internal modes and direct feedthrough (modified P1.7-11)}
[Adapted from Lathi 1.7-11]
For a certain LTI system, the output $y(t)$ depends on the input $x(t)$ and two internal modes parameterized by initial conditions $q_1(0)$ and $q_2(0)$. The following observations were made (all signals are right-sided, that is, defined for $t\geq 0$, due to an implicit unit step $u(t)$):

\begin{center}
\begin{tabular}{c c c c}
\hline
$x(t)$ & $q_1(0)$ & $q_2(0)$ & $y(t)$ \\
\hline
$0$ & $1$ & $-1$ & $e^{-t}u(t)$ \\
$0$ & $2$ & $\ \,1$ & $e^{-t}(3t+2)u(t)$ \\
$u(t)$ & $-1$ & $-1$ & $2\,u(t)$ \\
\hline
\end{tabular}
\end{center}

For $q_1(0)=q_2(0)=0$ and the pulse input
\[
x(t)=\Pi_{[-5,\,5]}(t)\;=\;u(t+5)-u(t-5).
\]
Find $y(t)$ and sketch it \textbf{[20 points]}.

\vspace*{\fill}
\begin{center}
[use more pages if needed]
\end{center}

\end{document}